# Metadata for Lofti 2025 --> 2. SNc pan-DA GCaMP6f recordings, STN & PPN stim
# TODO add ogen stimulation metadata
NWBFile:
  related_publications:
    - https://doi.org/10.1101/2025.06.03.657460
  keywords:
    - fiber photometry
    - SNc
    - dopaminergic neurons
    - GCaMP6f
    - calcium imaging
    - Parkinson's disease
  experiment_description: Mice were freely moving on a plastic tub.
    Simultaneous passive optogenetic stimulation and fiber photometry recordings were conducted during the first two days.
    Excitatory inputs from either the STN or PPN to SN were stimulated.
    Recordings of GCaMP6f fluorescence signal captured pan-DA activity in the substantia nigra pars compacta in VGLUT2-Cre x DAT-Flp mice.
  institution: UC San Diego School of Medicine
  lab: Hnasko
  experimenter:
    - Hadjas, Lotfi
    - Hollon, Nick
  surgery:
    Mice > 6 weeks old were anesthetized with isofluorane (4% for induction and 1-2% for maintenance), and provided with pre- and post-surgical analgesic carprofen (5 mg/kg i.p).
    For calcium recordings in VGLUT2-Cre x DAT-Flp mice were injected with 300 nl of AAV1-Ef1a-fDIO-GCaMP6f (4e12 vg/mL, Addgene 1283125) in SNc (AP -3.2, ML +/-1.3, DV 4.3).
    For optogenetic stimulation, 150-200 nl of AAV5-Syn-FLEX-ChrimsonR-tdTomato (4 - 8.5e12 vg/ml, Addgene 62723) was injected in either STN (AP -2.00, ML +/-1.6, DV -4.5) or PPN (AP -4.48, ML +/- 1.1, DV -3.75).
    A fiber (400-um core, 0.39 NA, 6-mm length, 1.25-mm diameter black ceramic ferrule, RWD) was implanted in SNc (AP -3.2, ML +/-1.4, DV -4.1).
Subject:
  species: Mus musculus
  description:
    All mouse experiments were performed in accordance with protocols approved by UCSD Institutional Animal Care and Use Committee.
    Male and female mice were bred at UCSD and group-housed on a 12-hour light/dark cycle, with food and water ad libitum.
    VGLUT2-Cre (Slc17a6tm2(cre)Lowl, RRID:IMSR_JAX:016963) and VGAT-Flp (Slc32a1tm1.1(flpo)Hze, RRID:IMSR_JAX:029591) mice were obtained from the Jackson Laboratory and maintained backcrossed on to C57BL/6J (RRID:IMSR_JAX:000664).
    The DAT-Flp (Slc6a3em1(flpo)Hbat, RRID:IMSR_JAX:035436) were generously provided by Dr. Helen Bateup (UC Berkeley).
    VGLUT2-PhiC31 (Jeong et al. 2024) mice were generously provided by Dr. Lim (UC San Diego).
    DAT-Flp (Slc6a3em1(flpo)NW Jax and RRID) and Anxa1-Cre (RRID:MMRRC_069931-MU) were generously provided by Dr.Awatramani (Northwestern).
  age: P6W
  sex: U
  strain: C57BL/6J
  genotype: VGLUT2-IRES-CRE/DAT-flp
Behavior:
  ExternalVideos:
    BehavioralVideo:
      description: |
        Video recording of the mouse's behavior. Recorded using a camera mounted on the ceiling above the chambers.
      device:
        name: BehavioralCamera
        description: Camera mounted on ceiling above chambers for behavioral recording
Ophys:
  FiberPhotometry:
    OpticalFiberModels:
      - name: optical_fiber_model_1
        description: Chronically implantable optic fiber.
        manufacturer: RWD
        model_number: <model of the optical fiber> # TODO add model number
        numerical_aperture: 0.39
        core_diameter_in_um: 400.0
        active_length_in_mm: 6.0
        ferrule_diameter_in_mm: 1.25
        ferrule_name: black ceramic ferrule
    OpticalFibers:
      - name: optical_fiber_SNc
        description: Chronically implanted optic fiber.
        model: optical_fiber_model_1
        serial_number: <serial number of the optical fiber> # TODO add serial number
        fiber_insertion:
          insertion_position_ap_in_mm: -3.2
          insertion_position_ml_in_mm: 1.4
          insertion_position_dv_in_mm: -4.1
          position_reference: bregma
          hemisphere: right

    ExcitationSourceModels:
      - name: excitation_source_model_calcium
        description: excitation source for the sensor's fluorescence signal.
        manufacturer: Tucker-Davis Technologies
        model_number: RZ5P or RZ10x
        source_type: LED
        excitation_mode: one-photon
        wavelength_range_in_nm: [460, 470]
      - name: excitation_source_model_isosbestic
        description: excitation source for the sensor's isosbestic control.
        manufacturer: Tucker-Davis Technologies
        model_number: RZ5P or RZ10x
        source_type: LED
        excitation_mode: one-photon
        wavelength_range_in_nm: [400, 410]
    ExcitationSources:
      - name: excitation_source_calcium_signal
        description: excitation source for the sensor's fluorescence signal (465nm) modulated at 210 Hz.
        model: excitation_source_model_calcium
        power_in_W: 0.0002
      - name: excitation_source_isosbestic_control
        description: excitation source for the sensor's isosbestic control (405nm) modulated at 330 Hz.
        model: excitation_source_model_isosbestic
        power_in_W: 0.0002

    PhotodetectorModels:
      - name: photodetector_model
        description: <description of the photodetector model> # TODO add description
        manufacturer: <manufacturer of the photodetector> # TODO add manufacturer
        model_number: <model of the photodetector> # TODO add model number
        detector_type: photodiode # TODO check detector type
        wavelength_range_in_nm: [500, 550] #TODO check wavelength range
        gain: -1.0
        gain_unit: V/W
    Photodetectors:
      - name: photodetector
        description: <description of the photodetector> # TODO add description
        model: photodetector_model
        serial_number: <serial number of the photodetector> # TODO add serial number
    BandOpticalFilterModels:
      - name: emission_filter_model
        description: <description of emission filter model> # TODO add description
        manufacturer: <manufacturer of the emission filter> # TODO add manufacturer
        model_number: <model of the emission filter> # TODO add model number
        filter_type: Bandpass
        center_wavelength_in_nm: -1.0
        bandwidth_in_nm: -1.0
      - name: excitation_filter_model
        description: <description of excitation filter model> # TODO add description
        manufacturer: <manufacturer of the excitation filter> # TODO add manufacturer
        model_number: <model of the excitation filter> # TODO add model number
        filter_type: Bandpass
        center_wavelength_in_nm: -1.0
        bandwidth_in_nm: -1.0

    BandOpticalFilters:
      - name: emission_filter
        description: <description of emission filter> # TODO add description
        model: emission_filter_model
      - name: excitation_filter
        description: <description of excitation filter> # TODO add description
        model: excitation_filter_model

    DichroicMirrorModels:
      - name: dichroic_mirror_model
        description: <description of the dichroic mirror model> # TODO add description
        manufacturer: <manufacturer of the dichroic mirror> # TODO add manufacturer
        model_number: <model of the dichroic mirror> # TODO add model number
        cut_on_wavelength_in_nm: -1.0
        cut_off_wavelength_in_nm: -1.0
        reflection_band_in_nm: [-1.0, -1.0]
        transmission_band_in_nm: [-1.0, -1.0]
        angle_of_incidence_in_degrees: -1.0

    DichroicMirrors:
      - name: dichroic_mirror
        description: <description of the dichroic mirror> # TODO add description
        model: dichroic_mirror_model
        serial_number: <serial number of the dichroic mirror> # TODO add serial number

    FiberPhotometryViruses:
      - name: viral_vector_gcamp6f
        description: AAV1 viral vector expressing GCaMP6f calcium sensor under EF1a promoter for fiber photometry recording in SNc
        manufacturer: Addgene (catalog number 1283125)
        construct_name: AAV1-Ef1a-fDIO-GCaMP6f
        titer_in_vg_per_ml: 4.0e+12
    FiberPhotometryVirusInjections:
      - name: viral_vector_injection_SNc
        description: Viral injection of GCaMP6f in SNc.
        viral_vector: viral_vector_gcamp6f
        location: Substantia Nigra pars compacta (SNc)
        hemisphere: right
        reference: bregma at the cortical surface
        ap_in_mm: -3.2
        ml_in_mm: 1.3
        dv_in_mm: -4.3
        volume_in_uL: 0.3

    FiberPhotometryIndicators:
      - name: GCaMP6f
        description: GCaMP6f calcium sensor in SNc dopaminergic neurons
        manufacturer: Addgene
        label: GCaMP6f
        viral_vector_injection: viral_vector_injection_SNc

    FiberPhotometryTable:
      name: fiber_photometry_table
      description: For monitoring calcium dynamics in SNc dopaminergic neurons, a fiber was implanted in SNc.
      rows:
        - name: 0
          location: SNc
          excitation_wavelength_in_nm: 465.0
          emission_wavelength_in_nm: 515.0 #TODO check emission wavelength
          indicator: GCaMP6f
          optical_fiber: optical_fiber_SNc
          excitation_source: excitation_source_calcium_signal
          photodetector: photodetector
          emission_filter: emission_filter
          excitation_filter: excitation_filter
          dichroic_mirror: dichroic_mirror
        - name: 1
          location: SNc
          excitation_wavelength_in_nm: 405.0
          emission_wavelength_in_nm: 515.0 #TODO check emission wavelength
          indicator: GCaMP6f
          optical_fiber: optical_fiber_SNc
          excitation_source: excitation_source_isosbestic_control
          photodetector: photodetector
          emission_filter: emission_filter
          excitation_filter: excitation_filter
          dichroic_mirror: dichroic_mirror

    FiberPhotometryResponseSeries:
      - name: calcium_signal_SNc
        description: The fluorescence from the calcium signal from SNc.
        stream_name: _465A # TODO check stream name
        stream_indices: null
        unit: a.u.
        fiber_photometry_table_region: [0]
        fiber_photometry_table_region_description: The region of the FiberPhotometryTable corresponding to the calcium signal of SNc.
      - name: isosbestic_control_SNc
        description: The fluorescence from the isosbestic control from SNc.
        stream_name: _405A # TODO check stream name
        stream_indices: null
        unit: a.u.
        fiber_photometry_table_region: [1]
        fiber_photometry_table_region_description: The region of the FiberPhotometryTable corresponding to the isosbestic control of SNc.

Optogenetics:
  stimulation_software: TDT Synapse
  excitation_wavelength_in_nm: 635.0 # LED wavelength for ChrimsonR
  OptogeneticViruses:
    - name: viral_vector_ogen
      description: pAAV-Syn-FLEX-rc[ChrimsonR-tdTomato] (AAV5) viral vector was used for optogenetic experiments.
      manufacturer: Addgene (catalog number 62723)
      construct_name: pAAV-Syn-FLEX-rc[ChrimsonR-tdTomato] (AAV5)
      titer_in_vg_per_ml: 4.0e+12 # TODO check titer, a range of 4 - 8.5e12 is reported in the paper.
  OptogeneticVirusInjections:
    - name: viral_vector_injection_STN
      description: Viral injection into the Subthalamic Nucleus (STN).
      viral_vector: viral_vector_ogen
      location: STN
      hemisphere: right # TODO: get hemisphere from a subject-wise map
      reference: bregma at the cortical surface
      ap_in_mm: -2.00
      ml_in_mm: 1.6 # TODO: get ML coordinate from a subject-wise map (depends on hemisphere)
      dv_in_mm: -4.5
      volume_in_uL: 0.150 # TODO check volume, a range of 150 - 200 nl is reported in the paper.
    - name: viral_vector_injection_PPN
      description: Viral injection into the Pedunculopontine Nucleus (PPN).
      viral_vector: viral_vector_ogen
      location: PPN
      hemisphere: right # TODO: get hemisphere from a subject-wise map
      reference: bregma at the cortical surface
      ap_in_mm: -4.48
      ml_in_mm: 1.1 # TODO: get ML coordinate from a subject-wise map (depends on hemisphere)
      dv_in_mm: -3.75
      volume_in_uL: 0.150 # TODO check volume, a range of 150 - 200 nl is reported in the paper.
  OptogeneticEffectors:
    - name: chrimsonR_STN
      description: ChrimsonR opsin used for optogenetic stimulation injected into the STN.
      manufacturer: Addgene
      label: ChrimsonR-tdTomato
      viral_vector_injection: viral_vector_injection_STN
    - name: chrimsonR_PPN
      description: ChrimsonR opsin used for optogenetic stimulation injected into the PPN.
      manufacturer: Addgene
      label: ChrimsonR-tdTomato
      viral_vector_injection: viral_vector_injection_PPN
  ExcitationSourceModels:
    - name: optogenetic_excitation_source_model
      description: Red LED device used for optogenetic stimulation.
      manufacturer: Shanghai laser
      model_number: <model of the LED device> # TODO add model number
      source_type: LED
      excitation_mode: one-photon
  ExcitationSources:
    - name: optogenetic_excitation_source
      description: Red LED device used for optogenetic stimulation.
      model: optogenetic_excitation_source_model
      power_in_W: 0.005 # 5mW
  OptogeneticSitesTable:
    description: Information about each optogenetic site, including the excitation source, and targeted effector.
    reference: Bregma at the cortical surface
    rows:
      - name: 0
        excitation_source: optogenetic_excitation_source
        # TODO this setup does not include an optical fiber for optogenetic stimulation (probably this is a requirement for the NWB schema --> need to open an issue)
        effector: chrimsonR_STN
      - name: 1
        excitation_source: optogenetic_excitation_source
        effector: chrimsonR_PPN
